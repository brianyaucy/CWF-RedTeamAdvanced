# Jump Server

- [Jump Server](#jump-server)
  - [Local Enumeration](#local-enumeration)
  - [Access scada-hsot.scada.local](#access-scada-hsotscadalocal)

---

## Local Enumeration

First see if the current user has SUDO privilege:

```
sudo -l
```
However we cannot run `sudo`:
![picture 43](images/02761d106996b99da376e40fcaf93253c49a3502e81359108ff017e2aaebd45f.png)  

<br/>

Check the current user's home, an nuclear operating instruction is shown:

```
cat Core_Reactor_notes
```

* Result:

```
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@


        !!This file contains important information for
        proper operation of Nuclear Core Reactor!!


Extreme focus is on the heat generated by the Nuclear Reactor &
the cooling systems used to depress the amount of heat.


Scientist must be extreme cautious when dealing with the following cases:

- Loss or inadvertant withdrawl of coolant rods.

- Loss of Electric Power (Station Blackout)

- Failure of reactor protection systems.

- Natural Calamity (Earthquakes and fire)

The most probable case would be of inadvertant withdrawl of rods. 
On the SCADA-HOST, the PCTRAN application is the control panel for monitoring
and operating Nuclear Core Reactor. 

With access to PCTRAN control panel, the following procedure can replicate 
NUCLEAR MELTDOWN in core's reactor.

Code Control > Malfunctions > set option 12 (Inadvertent Rod Withdrawl)


Modify Delay Time (5)
Failure Fraction (100)
Check the active box 


Then, RUN the application, in 5 seconds, a message "OVERFlow" appears.

CAUTION: Nuclear Meltdown could be achieved by following the above procedure. 

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@


```

<br/>

Checking the home directory, there is a folder related to Firefox `.mozilla`:

![picture 44](images/8acc3626f4f652867ccf515429a58ddea80c77f3f031b145e5907d04a9642d76.png)  

<br/>

To check the browsing history, look for the sqlite database named `places.sqlite`:

![picture 45](images/e35f7cd8887be6e8233e852b132b83c0c3c525aa5e959d0d164f6ff204b20cb2.png)  

<br/>

Then use `sqlite3` to check the history:

```
sqlite3 places.sqlite
.tables
select * from moz_places;
```

![picture 46](images/9eeed0ff9bb20d3238d1b164b75797b5b5c9ccfc71ea12c10a627e7986b09e21.png)  

This reveal an unseen internal URL `https://scada-host.scada.local`, as well as the corresponding credential:
* `Administrator` / `SCADAAdmin!@#$%`

<br/>

Inspect the hosts file:

```
cat /etc/hosts
```

![picture 47](images/10d3da831b25485896f9749c89799f6634cc53cfb30a4d691ddce26580c4bedc.png)  

The IP address of `scada-host.scada.local` is 10.2.1.1.

<br/>

Check if this is reachable from proxychains on the attacker machine:

```
proxychains nmap -Pn -sT 10.2.1.1 -p 80
```

![picture 48](images/ed8b7a0002823d1572b2a8960410de1b63a49b03c023300de002b6ce00feb424.png)  

Not reachable.

<br/>

Test if it is reachable by the jump-server:

```
telnet 10.2.1.1 80
```

![picture 49](images/5913aab78cbe52e9679d9465d4d2a9823aad18af3253cabf5c2a1318f15fed89.png)  

As shown, jump-server can reach 10.2.1.1 (scada-host.scada.local).

<br/>

## Access scada-hsot.scada.local

To access, we need to do local port forward on the jump-server. To do so, we can setup Dynamic port forwarding since we know the SSH credential:

```
proxychains -N -D 9051 jump-admin@10.1.1.4
```

<br/>

Modify local `/etc/proxychains.conf`:

![picture 50](images/242d8197b37f2bc177abe9af18aff19f6736684057d5651af6f9f97eff9b98b5.png)  

<br/>

Add `scada-host.scada.local` to the local `/etc/hosts`:

```
echo "scada-host.scada.local 10.2.1.1" >> /etc/hosts
```

<br/>

With configured FoxyProxy, try to access `https://10.2.1.1/RDWeb/Pages/en-US/login.aspx`:

![picture 51](images/ffac24d973dc7eff3ad9c98699ee48be1c84b3d90eab58bc81bad6f234e8e428.png)  

<br/>

Try to login with the previously found credential:
* `scada.local\Administrator` / `SCADAAdmin!@#$%`

![picture 52](images/72f143e306f8d6b7129b31dc9aafaea813f2764ec54264736045e1718aed921c.png)  

Login successfully.

<br/>

